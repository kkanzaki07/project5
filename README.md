Code is still messy but that will do
